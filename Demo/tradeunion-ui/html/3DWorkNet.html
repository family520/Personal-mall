<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="../images/logoIcon.png" type="image/icon"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <title>中国工业互联网研究院测试中心</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/materialdesignicons.min.css" rel="stylesheet">
    <link href="../css/style.min.css" rel="stylesheet">
    <link href="../css/bootstrap-treeview.css" rel="stylesheet">
    <link href="../css/commonStyle.css" rel="stylesheet">
    <link href="../css/layui.css" rel="stylesheet"/>
    <link href="../plus/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../plus/iview/iview.css"/>

    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../plus/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="../plus/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="../plus/layer/layer.js"></script>
    <script src="../js/template-web.js"></script>
    <script src="../js/bootstrap-treeview.js"></script>
    <script src="../js/httpUtils.js"></script>
    <script src="../plus/iview/vue.min.js"></script>
    <script src="../plus/iview/iview.min.js"></script>
</head>

<body style="background: #f5f6fa;">
<div id="hander">
    <script>
        $(function () {
            $("#hander").load("handMenu.html");
        });
    </script>
</div>
<main class="lyear-layout-content" style="display: none">
    <iframe src="" id="ifr" width="100%" frameborder="0" scrolling="no"></iframe>
</main>

<script>
    // 请求3D地址
    $.ajax({
        url: addToUrlToken(deviceServiceUrl + "/platformparam/list"),
        type: "get",
        contentType: "application/json",
        dataType: "json",
        timeout: 10000,
        data: {"platformType": 4},
        async: false,
        success: function (data) {
            plan_3D_url = data.data[0].url_3d;;
        }
    });
    // 请求3D的service_key和service_id
    $.ajax({
        url: addToUrlToken(deviceServiceUrl + "/platformparam/list"),
        type: "get",
        contentType: "application/json",
        dataType: "json",
        timeout: 10000,
        data: {"platformType": 1},
        async: false,
        success: function (data) {
            service_id = data.data[0].serviceId;
            service_key = data.data[0].serviceKey;
            call_back_url = data.data[0].callBackUrl;
        }
    });
    var token = getToken();
    var url = plan_3D_url + "/otheAPI/openWorkstation";
    url += "?user_token=" + token;
    $("#ifr").attr("src", url);

    function changeFrameHeight() {
        var ifm = document.getElementById("ifr");
        ifm.height = document.documentElement.clientHeight-68;
    }

    window.onresize = function () {
        changeFrameHeight();
    };

    $(function () {
        changeFrameHeight();
    });

</script>
</body>
</html>